{% extends 'admin/base1.html' %}
{% load static %}
{% block content %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<div class="col-md-12 grid-margin stretch-card">
    <div class="card">
      <div class="card-body">
        <h4 class="card-title">Add Delivery Agent</h4>
        {% if messages %}
        
        <div class="alert alert-danger">
          {% for message in messages %}
           {{ message }}
           {% endfor %}
        </div>
        {% endif %}
        <form method="post" id= "yourForm" enctype="multipart/form-data" onsubmit="return validateForm()">
            {% csrf_token %}
            <p class="card-description">Basic Info</p>
          <div class="form-group row">
            <label for="exampleInputUsername2" class="col-sm-3 col-form-label">Agent Name</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="agent_name" placeholder="Name" name="agent_name" required>
              <span id="agent_name_error" class="text-danger"></span>
            </div>
          </div>
          <div class="form-group row">
            <label for="exampleInputEmail2" class="col-sm-3 col-form-label">Address</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="address" placeholder="Address" name="place" required>
              <span id="address_error" class="text-danger"></span>
            </div>
          </div>
          <div class="form-group row">
            <label for="exampleInputMobile" class="col-sm-3 col-form-label">Mobile</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="mobile" placeholder="Mobile number" name="phone_number" required>
              <span id="phone_number_error" class="text-danger"></span>
            </div>
          </div>
          
          <p class="card-description">Account</p>
          <div class="form-group row">
            <label for="email" class="col-sm-3 col-form-label">Email</label>
            <div class="col-sm-9">
              <input type="email" class="form-control" id="email" placeholder="Email" name="email" required>
              <span id="email_error" class="text-danger"></span>

            </div>
          </div>
          
          <button type="submit" class="btn btn-primary mr-2">Submit</button>
          <a class="btn btn-dark" href="{% url 'add_deliveryagent' %}">Cancel</a>
        </form>
      </div>
    </div>
  </div>
  <script>
    $(document).ready(function () {
    
        $("input[name='agent_name']").keyup(function () {
            validateName("input[name='agent_name']");
        });
    
        $("input[name='phone_number']").keyup(function () {
            validatePhoneNumber("input[name='phone_number']");
        });
    
        $("input[name='place']").keyup(function () {
            validateAddress("input[name='place']");
        });
    
       
        $("input[name='email']").keyup(function () {
            validateEmail("input[name='email']");
        });
      

    });
    
    function validateName(fieldSelector) {
        var ownerName = $(fieldSelector).val().trim();
        var lettersOnlyPattern = /^[A-Za-z\s]+$/;
        if (ownerName === "") {
            $("#agent_name_error").html("Name is required").css("color", "red");
          } 
        else if (!lettersOnlyPattern.test(ownerName)) {
            $("#agent_name_error").html("Name should contain only letters").css("color", "red");
        } else {
            $("#agent_name_error").html("");
        }
    }
    
    function validatePhoneNumber(fieldSelector) {
        var phoneNumber = $(fieldSelector).val().trim();
        var phoneNumberPattern = /^(\+91-|0)?[6-9]\d{9}$/; // Adjust the pattern based on your phone number requirements
        if (phoneNumber === "") {
            $("#phone_number_error").html("Phone Number is required").css("color", "red");
          } 
        else if (!phoneNumberPattern.test(phoneNumber)) {
            $("#phone_number_error").html("Phone Number should be atleast 10 numbers and cannot contain alphabets").css("color", "red");
        } else {
            $("#phone_number_error").html(""); // Clear the error message
        }
    }
    
    function validateAddress(fieldSelector) {
        var address = $(fieldSelector).val().trim();
        var addressError = $("#address_error");
        if (address === "") {
            $("#address_error").html("Address is required").css("color", "red");
          } 
        else if (address.length > 150) {
            addressError.html("Address must be upto 150 characters long").css("color", "red");
            return; // Exit the function if the address length is invalid
        }
        else {
            $("#address_error").html(""); // Clear the error message
        }
    }
    function validateEmail(fieldSelector) {
        var email = $(fieldSelector).val().trim();
        var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        if (email === "") {
            $("#email_error").html("Enter your Email Id").css("color", "red");
        } else if (!filter.test(email)) {
            $("#email_error").html("Incorrect Email Id").css("color", "red");
        } else {
            $("#email_error").html("");
        }
    }
   
    
    
    
    function validateForm() {
        // Check if there are any validation errors
        const errorElements = $(".text-danger");
        for (const errorElement of errorElements) {
            if ($(errorElement).html() !== "") {
                return false; // Prevent form submission if there are validation errors
            }
        }
    
        return true; // Submit the form if there are no validation errors
    }
    
    
    
    </script>
    
{% endblock %}



